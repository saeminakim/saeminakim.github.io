---
layout: post
title: SQLD 수업 정리_220115
slug: SQLD 수업 정리_220115
categories: studylog
tags: SQL, SQLD
description: >
  SQL 수업 내용 정리
---
# SQLD 수업 정리_220115

### JOIN

- 조인문이 활용되는 이유
    1. 성능상의 이유
        - 모든 정보를 저장하는 테이블을 사용하는 것이 직관적이고 쉽게 SQL을 작성할 수 있지만 저장 사이즈에 따라 조회 성능이 떨어짐
        - 작게 나누어진 테이블을 조회하는 것이 성능상에 유리하기 때문에 조인문을 활용하여 처리하는 것이 성능 향상에 좋음
    2. 데이터의 무결성
        - 하나의 테이블로 모든 데이터를 저장하는 경우, 데이터의 중복, 데이터 무결성의 훼손이 발생하기 때문에 작게 나누어진 테이블을 사용하여 데이터의 중복을 피하고 제약조건을 활용하여 무결성을 준수할 수 있음
    3. SQL 튜닝을 활용하여 성능의 향상을 도모할 수 있음
        - 최초 데이터베이스 설계시 고려하지 못했던 영역으로 조인문의 성능이 감소하는 경우, 튜닝 과정을 통해서 SQL문의 성능을 향상 시킬 수 있음

### ANSI 표준 조인문

- where절을 활용한 전통적인 SQL 조인문은 각 데이터베이스 벤더의 영향을 받는 영역
    
    ex) outer 조인은 벤더마다 문법이 상이함
    
- ANSI 표준 조인문은 모든 데이터베이스 벤더가 준수해야 하는 표준 조인 문법으로 일관성 있는 SQL의 작성, 직관적인 문법을 제공

- ANSI 표준 조인문의 종류
    - INNER JOIN (EQUI JOIN)
    - NATURAL JOIN (EQUI JOIN)
    - CROSS JOIN
    - OUTER JOIN(LEFT, RIGHT, FULL)

- ANSI 표준 조인문의 문법
    
    ```sql
    SELECT [컬럼명, *] 
    FROM 테이블1 [ANSI JOIN 타입, INNER, OUTER, ...] 테이블2
    [ON 조인 조건 / USING 조인 컬럼명]
    WHERE 조인된 테이블에서 레코드를 추출할 조건
    ```
    

- ANSI 표준 조인문을 활용할 시, ON 절과 WHERE의 분리로 인하여 조인 조건, 데이터 추출 조건을 분리할 수 있어 SQL문이 직관적임

```sql
-- OUTER 조인
-- 기본적으로 조인문은 다수개의 테이블에서 연관성이 존재하는 데이터를 결합하여 추출하는 문법
-- OUTER 조인은 EQUI 조인과 다르게 연관성(조건식에 만족하는)이 존재하지 않아도 특정 위치의 테이블의 모든 정보를 조회하고자 할 때 사용하는 조인문

-- 모든 팀은 홈구장을 가지고 있음(STADIUM_ID)
select * 
from team;

-- 중복을 제거한 홈구장의 아이디 정보를 조회(15개)
select distinct stadium_id
from team;

-- 경기장의 정보를 조회(20개)
select *
from stadium;

-- 각 팀의 아이디와 팀명, 경기장 아이디, 경기장 이름을 출력
-- EQUI 조인을 활용
-- 전체 경기장의 수는 20개이지만 팀의 홈구장으로 사용하는 경기장은 15개 => 아래의 쿼리 실행시 15개의 결과만 나오게 됨
-- 그러므로 남은 5개는 EQUI 조인으로 확인 불가
select t.team_id, t.team_name, s.stadium_id, s.stadium_name
from team t, stadium s
where t.stadium_id = s.stadium_id;

-- 각 팀의 아이디와 팀명, 경기장 아이디, 경기장 이름을 출력
-- 팀의 홈구장으로 사용되지 않는 일반 경기장도 조회
select t.team_id, t.team_name, s.stadium_id, s.stadium_name
from team t, stadium s
-- 오라클에서 where절을 활용한 outer 조인 문법
-- where 테이블1.컬럼명[(+)] = 테이블2.컬럼명[(+)];
-- 가져오는 쪽에 (+) 쓰는게 아니라 붙여줘야 하는 부분에 (+) 사용 => 확장시켜줘야 한다는 의미로 이해
where t.stadium_id(+) = s.stadium_id;

-- EMP 테이블과 DEPT 테이블을 조인하여 사원의 정보와 부서의 정보를 출력하세요
-- (사원명emp, 부서번호emp/dept, 부서명dept)
select e.ename, e.deptno, d.dname 
from emp e, dept d
where e.deptno = d.deptno;

-- 사원이 존재하는 부서의 개수를 조회하세요
select count(distinct(d.deptno)) 
from emp e, dept d
where e.deptno = d.deptno;

-- EMP 테이블과 DEPT 테이블을 조인하여 사원의 정보와 부서의 정보를 출력하세요
-- (사원명emp, 부서번호emp/dept, 부서명dept)
-- 모든 부서의 정보를 포함해서 조회
select e.ename, e.deptno, d.dname 
from emp e, dept d
where e.deptno(+) = d.deptno;
```

